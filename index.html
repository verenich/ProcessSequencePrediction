<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Predictive Business Process Monitoring with LSTM Neural Networks by verenich</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Predictive Business Process Monitoring with LSTM Neural Networks</h1>
      <h2 class="project-tagline">Supplementary materials for the paper submitted to CAiSE &#39;17</h2>
      <a href="https://github.com/verenich/ProcessSequencePrediction" class="btn">View on GitHub</a>
      <a href="https://github.com/verenich/ProcessSequencePrediction/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/verenich/ProcessSequencePrediction/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <p>Following are the supplementary material for the article <a href="http://example.com">"Predictive Business Process Monitoring with
LSTM Neural Networks"</a> by Niek Tax, Ilya Verenich, Marlon Dumas and Marcello La Rosa.</p>

<p>The code provided in this repository can be readily used to perform the following predictive tasks:</p>

<ul>
<li>Prediction of the next type of activity to be executed in a running process instance</li>
<li>Prediction of the timestamp of the next type of activity to be executed</li>
<li>Prediction of the continuation of a running instance, i.e. its suffix</li>
<li>Prediction of the remaining cycle time of an instance</li>
</ul>

<p>The scripts trains an <a href="https://en.wikipedia.org/wiki/Long_short-term_memory">LSTM</a>- or <a href="https://en.wikipedia.org/wiki/Recurrent_neural_network">RNN</a>-based predictive model using the data about historical, i.e. completed process instances. Next, the models are evaluated on running, i.e. incomplete instances.</p>

<p><strong>Requirements:</strong><br>
Python 2. Additionally, the following Python libraries are required to run the code: <a href="https://keras.io/"><em>keras</em></a> (as a backend, you need either <em>theano</em> or <em>tensorflow</em>), <em>unicodecsv</em>, <em>numpy</em>, <em>jellyfish</em>, <em>sklearn</em>, <em>matplotlib</em>.<br>
Note you might need the latest version of <em>keras</em> to run the code. Install it as:<br>
<code>pip install git+git://github.com/fchollet/keras.git</code></p>

<p><strong>USAGE:</strong><br>
<strong>Model training:</strong><br>
<code>python train.py</code><br>
This script trains a two-layer LSTM model with one shared layer on one of the data files in the data folder of this repository (by default, on the <em>helpdesk</em> event log). The input file can be changed to another file from the data folder in by changing the path in both line 47 and 124. It is recommended to run this script on GPU, as recurrent networks are quite computationally intensive. </p>

<p><strong>Evaluation:</strong><br>
<code>python evaluate_next_activity_and_time.py</code><br>
This script takes as input the LSTM or RNN weights found by <code>train.py</code> and predicts the next event and its relative timestep for a partial trace. Change the path in line 172 of this script to point to the h5 file with LSTM or RNN weights generated by train.py As an example, we provide the file <em>model_89-1.50.h5</em> with one of the trained models</p>

<p><code>python evaluate_suffix_and_remaining_time.py</code><br>
This script predicts the continuation of a partial trace, i.e. its suffix, until its completion.</p>

<p><code>python calculate_accuracy_on_next_event.py</code>.
This script evaluates the performance of the next event prediction (not the whole suffix). It takes the output of <code>evaluate_suffix_and_remaining_time.py</code> as input, therefore, the latter needs to be executed first</p>

<p><strong>Known issues:</strong>
On some systems, the scripts cause an error <em>UnicodeEncodeError: 'ascii' codec can't encode character u'\xa7' in position 0: ordinal not in range(128)</em>. As a temporary solution, you can uncomment the following lines in the beginning of a script:<br>
<code>import sys</code><br>
<code>reload(sys)</code><br>
<code>sys.setdefaultencoding("utf-8")</code>  </p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/verenich/ProcessSequencePrediction">Predictive Business Process Monitoring with LSTM Neural Networks</a> is maintained by <a href="https://github.com/verenich">verenich</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
